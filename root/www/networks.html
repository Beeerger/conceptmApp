<!DOCTYPE html>
<html>
    <!-- //Header mit Metadaten-->
    <head> 
        <meta charset="utf-8">
        <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
        <title>Concept Map</title>

       <!-- Download the necessary resources for the network from unpkg-->
        <script
          type="text/javascript"
          src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"
        ></script>

        <!-- download the awsome-font-->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta2/css/all.min.css"
          integrity="sha512-YWzhKL2whUzgiheMoBFwW8CKV4qpHQAEuvilg9FAn5VJUDwKZZxkJNuGM4XkWuk94WCrrwslk8yWNGmY1EduTA=="
          crossorigin="anonymous" referrerpolicy="no-referrer" />
    </head>

    <body style="height:100%;">

      <!--div containing the network canvas-->
      <div id="mynetwork"></div>

      <!-------------------START ui stuff ----------------------->

      <!--import for css stylesheet-->
      <link rel="stylesheet" href="css/networks.css" media="screen" /> 

      <!--for the add menu we use some form of pie-popup-menu in the upper left corner-->

      <!-- pie1-3 are the three pi parts of the menu, from bottom left to top right -->
      <div class="pie pie1" onclick="document.body.classList.remove('active')">
        <div class="pie-color pie-color1">
              <!-- first, the add node button -->
              <svg class= "addIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40" width="100" height="100">
                <g data-name="addIcon">
                  <path d="M16 31a15 15 0 1 1 15-15 15 15 0 0 1-15 15zm0-28a13 13 0 1 0 13 13A13 13 0 0 0 16 3z"
                  fill="#fff"/>
                  <path d="M17 24h-2a2 2 0 0 1-2-2v-3h-3a2 2 0 0 1-2-2v-2a2 2 0 0 1 2-2h3v-3a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v3h3a2 2 0 0 1 2 2v2a2 2 0 0 1-2 2h-3v3a2 2 0 0 1-2 2zm-7-9v2h4a1 1 0 0 1 1 1v4h2v-4a1 1 0 0 1 1-1h4v-2h-4a1 1 0 0 1-1-1v-4h-2v4a1 1 0 0 1-1 1z"
                  fill="#fff"/>
                </g>
              </svg>
        </div>
      </div>

      <div class="pie pie2" onclick="document.body.classList.remove('active')">
        <div class="pie-color pie-color2">
          <!-- then, the camera button -->
              <!-- <svg class="cameraIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" width="100" height="100" xml:space="preserve">
                <path d="M76.095 23.905c-5.208-5.208-13.649-5.208-18.854 0L50 31.145c-4.388 4.385-5.032 11.055-2.024 16.166l-.664.667c-5.111-3.011-11.781-2.366-16.169 2.021l-7.236 7.24c-5.208 5.209-5.208 13.649 0 18.857 5.202 5.205 13.649 5.209 18.854.004L50 68.859c4.388-4.388 5.03-11.055 2.025-16.168l.668-.668c5.11 3.008 11.777 2.363 16.162-2.021l7.239-7.236c5.209-5.212 5.206-13.656.001-18.861zM45.287 64.146l-7.239 7.239c-2.601 2.598-6.829 2.598-9.427-.003a6.671 6.671 0 0 1-.004-9.428l7.243-7.239a6.61 6.61 0 0 1 4.714-1.953c.586 0 1.152.101 1.705.247l-5.24 5.241a3.344 3.344 0 0 0 0 4.714 3.344 3.344 0 0 0 4.713 0l5.234-5.234c.586 2.22.036 4.678-1.699 6.416zm26.094-26.097-7.239 7.24c-1.735 1.738-4.192 2.285-6.413 1.699l5.238-5.238a3.344 3.344 0 0 0 0-4.713 3.347 3.347 0 0 0-4.717 0l-5.234 5.237c-.586-2.22-.039-4.678 1.695-6.413l7.243-7.243a6.62 6.62 0 0 1 4.714-1.953 6.62 6.62 0 0 1 4.713 1.953 6.675 6.675 0 0 1 0 9.431z"
                fill="#fff"/>
              </svg> -->
              <svg class="cameraIcon" xmlns="http://www.w3.org/2000/svg" viewBox="-10 -30 36 56">
                <path d="M21.65 3c-1.45 0-1.86.91-3.73 3.24A4 4 0 0 0 14 3H4a4 4 0 0 0-4 4v10a4 4 0 0 0 4 4h10a4 4 0 0 0 3.92-3.24l1.89 2.36A2.36 2.36 0 0 0 24 18.65V5.35A2.35 2.35 0 0 0 21.65 3zM16 17a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2zm6 1.65a.36.36 0 0 1-.62.22L18 14.65v-5.3l3.38-4.22a.36.36 0 0 1 .62.22z"
                fill="#fff"/>
        
              </svg>
        </div>
      </div>
      <div class="pie pie3" onclick="document.body.classList.remove('active')">
        <div class="pie-color pie-color3">
          <!-- last, the delete button -->
              <svg class="deleteIcon" xmlns="http://www.w3.org/2000/svg" viewBox = "0 0 30 30" width="100" height="100">
                <path d="M6 7a1 1 0 0 1 1 1v11a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V8a1 1 0 1 1 2 0v11a3 3 0 0 1-3 3H8a3 3 0 0 1-3-3V8a1 1 0 0 1 1-1z" 
                fill="#fff"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8a1 1 0 0 1 1 1v8a1 1 0 1 1-2 0V9a1 1 0 0 1 1-1zM14 8a1 1 0 0 1 1 1v8a1 1 0 1 1-2 0V9a1 1 0 0 1 1-1zM4 5a1 1 0 0 1 1-1h14a1 1 0 1 1 0 2H5a1 1 0 0 1-1-1zM8 3a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H9a1 1 0 0 1-1-1z" 
                fill="#fff"/>
              </svg>
        </div>
      </div>
      <!-- main menu icon -->
      <div class="menu" onclick="document.body.classList.toggle('active')">
        <svg class="hamburger" xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100">
              <g
                fill="none"
                stroke="#fff"
                stroke-width="7.999"
                stroke-linecap="round"
              >
                <path d="M 55,26.000284 L 24.056276,25.999716" />
                <path d="M 24.056276,49.999716 L 75.943724,50.000284" />
                <path d="M 45,73.999716 L 75.943724,74.000284" />
                <path d="M 75.943724,26.000284 L 45,25.999716" />
                <path d="M 24.056276,73.999716 L 55,74.000284" />
              </g>
            </svg>
      </div>
      <!------------------- END ui stuff ----------------------->
      


      <script source = "jquery-3.6.1.min.js"></script>
      <script type='text/javascript' src = "vis_network.js">  // network implementation </script>
      <script type='text/javascript' src = "qrscanner.js">    // qr code implementation </script>


      <!-- the script creating the network starts here -->
      <script type="text/javascript">

        // create an array with nodes
        // nodes have positive unique ids (excluding 0)
        var nodes = new vis.DataSet([
          { id: 1, label: "saure Lösung", x: -354, y: 1 },
          { id: 2, label: "Oxonium-Ionen", x: -215, y: 147 },
          { id: 3, label: "Säure", x: -159, y: 55 },
          { id: 4, label: "Protonendonator", x: -187, y: -37 },
          { id: 5, label: "Säure-Base-Paar", x: -8, y: 144 },
          { id: 6, label: "Säure-Base-Reaktion", x: 14, y: -40},
          { id: 7, label: "Base", x: 153, y: 64},
          { id: 8, label: "Protonenakzeptor", x: 215, y: -65},
          { id: 9, label: "basische Lösung", x: 390, y: -13},
          { id: 10, label: "Hydroxid-Ionen", x: 256, y: 152},
        ]);
  
        // create an array with edges
        // edges have negative unique ids (excluding 0)
        var edges = new vis.DataSet([
          { id: -1, from: 1, to: 2, label: "enthält" },      // , arrows:'to,from' possible individually
          { id: -2, from: 3, to: 1, label: "bildet mit Wasser" },
          { id: -3, from: 3, to: 4, label: "ist definiert als" },
          { id: -4, from: 3, to: 5, label: "ist Teil eines" },
          { id: -5, from: 5, to: 6, label: "ist Teil der" },
          { id: -6, from: 7, to: 5, label: "ist Teil eines" },
          { id: -7, from: 7, to: 8, label: "ist definiert als" },
          { id: -8, from: 7, to: 9, label: "bildet mit Wasser" },
          { id: -9, from: 9, to: 10, label: "enthält" },
        ]);

        //two counters for the IDs to ensure unique IDs
        let nextNodeID = 11
        let nextEdgeID = -10

        var options = {
          manipulation: {
            enabled: true,        // add an edit button
          },
          layout: {
            hierarchical: false,  // this makes two edges on same way visible, but lessens visibility
          },
          edges: {                // options set for all edges
            arrows: 'to',         // arrows on the "to" end of the edge
            physics: false,
            smooth: true,
          },
          nodes: {
            shape: "box",
            fixed: false,
            physics: false,
          }
        };

        var container = document.getElementById("mynetwork");

        var data = {
          nodes: nodes,
          edges: edges,
        };


        // build the network together
        var network = new vis.Network(container, data, options);

        // save the map to local storage
        SaveMap()

      </script>


      <!-- currently the script part with the functions, this is going to be outsourced to vis_network.js -->
      <script>

          // function to extract parameters for new node and call vis_network functions
          function createNode() {
            var name = getName()
            try {
              AddNode(name)
            }
            catch(err) {
              alert("Error creating the Node")
            }
          }

          // function to extract parameters for the node to delete and call vis_network functions
          function removeNode(){
            try {
              var name = getName()
              DeleteNode(name)
            }
            catch(err) {
              alert("Error removing the Node")
            }
            
          }

          // function to extract parameters for new edge and call vis_network functions
          function createEdge(){
            try {
              var name = getName()
              var [fromNode, toNode] = getConnection()
              AddEdge(name, fromNode, toNode)
            }
            catch(err) {
              alert("Error creating the Edge")
            }
            
          }

          // function to extract parameters for the edge to delete and call vis_network functions
          function removeEdge(){
            try {
              var name = getName()
              var [fromNode, toNode] = getConnection()
              DeleteEdge(name, fromNode, toNode)
            }
            catch(err) {
              alert("Error deleting the Edge")
            }
            
          }

          // function to return the name out of the text input
          function getName(){
            var name = document.getElementById("elementName").value;
            return name
          }

          // function to return the connecting nodes for the edge
          function getConnection(){
            var fromNode = document.getElementById("fromNode").value;
            var toNode = document.getElementById("toNode").value;
            return [fromNode, toNode]
          }

          // function logging info for debugging purposes
          function showInfo(){
            console.log("Next Node ID: ", nextNodeID)
            console.log("Next Edge ID: ", nextEdgeID)
            // console.log(data.nodes)
            // console.log(data.edges)
          }

      </script>


      <!-- black magic, very important, such danger -->
      <!-- <script type="text/javascript" src="cordova.js"></script> -->

    </body>
</html>
